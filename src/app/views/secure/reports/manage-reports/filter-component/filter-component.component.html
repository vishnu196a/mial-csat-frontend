<div class="modal-header">
  <h4 class="modal-title text-center">Select Filters</h4>
  <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
<div class="modal-body">
  <form [formGroup]="filterForm" (submit)="onFormSubmit()" class="mt-3" autocomplete="off">
    <div class="card">
      <div class="alert alert-warning" *ngIf="hasValidationError">
        <p>Please fix the following</p>
        <ul>
          <li *ngFor="let validationError of validationErrors">{{ validationError }}</li>
        </ul>
      </div>
      <div class="row card-body">
        <div class="form-group col-12">
          <label for="from">From Date<span class="text-danger">*</span></label>
          <input
            type="datetime-local"
            id="from"
            (change)="handleFilter()"
            formControlName="fromDate"
            class="form-control"
            [max]="maxDate"
          />
          <div *ngIf="formControls.fromDate.touched && formControls.fromDate.invalid">
            <small class="text-danger" *ngIf="formControls.fromDate.errors?.required"
              >From date is required</small
            >
          </div>
        </div>
        <div class="form-group col-12">
          <label for="to">To Date<span class="text-danger">*</span></label>
          <input
            type="datetime-local"
            id="to"
            (change)="handleFilter()"
            formControlName="toDate"
            class="form-control"
            [max]="maxDate"
          />
          <div *ngIf="formControls.toDate.touched && formControls.toDate.invalid">
            <small class="text-danger" *ngIf="formControls.toDate.errors?.required"
              >To date is required</small
            >
          </div>
          <div *ngIf="toDateValidator">
            <small class="text-danger">To date should be greater than from date</small>
          </div>
        </div>
        <div *ngIf="params ? params['filters']['Agent'] : false" class="form-group col-12">
          <label for="agent"> Agent </label>
          <ng-select
            [items]="agents"
            [clearable]="true"
            [searchable]="true"
            bindValue="id"
            bindLabel="name"
            formControlName="agent"
            placeholder="Select call status"
            notFoundText="No status found"
          >
          </ng-select>
        </div>
        <div *ngIf="params ? params['filters']['Mode of call'] : false" class="form-group col-12">
          <label for="callSource"> Mode of Call </label>
          <ng-select
            [items]="modeOfCall"
            [clearable]="true"
            [searchable]="true"
            bindValue="id"
            bindLabel="name"
            formControlName="callSource"
            placeholder="Select call source"
            notFoundText="No source found"
          >
          </ng-select>
        </div>
        <div *ngIf="params ? params['filters']['call type'] : false" class="form-group col-12">
          <label for="status"> Call Type </label>
          <ng-select
            [items]="callType"
            [clearable]="true"
            [searchable]="true"
            bindValue="name"
            bindLabel="name"
            formControlName="callType"
            placeholder="Select call type"
            notFoundText="No type found"
          >
          </ng-select>
        </div>

        <div class="form-group col-12 col-md-12">
          <div class="d-flex float-right">
            <button type="button" class="btn btn-dark mr-1" (click)="modalRef.hide()">Close</button>
            <app-loading-button
              [disabled]="filterForm.invalid || toDateValidator"
              [buttonText]="'Download'"
              [title]="'Click to download report'"
              [isLoading]="isLoading"
              [loadingText]="'Downloading...'"
              [hideTextOnSM]="true"
              [buttonIconClass]="'fas fa-download'"
            ></app-loading-button>
          </div>
        </div>
      </div>
    </div>
  </form>
</div>
